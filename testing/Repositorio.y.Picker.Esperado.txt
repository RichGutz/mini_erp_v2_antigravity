Objetivo:

El mini erp va a ser usado por muchos usuarios. La idea es asignar roles y hacer un tracking 
de las acciones de cada uno de ellos a traves del login con google que esta en HOME


PROBLEMA #1: PICKER Y REPOSITORIO CENTRALIZADO
===============================================

REQUERIMIENTO:
El picker en los modulos tiene el objetivo de guardar en un lugar seguro todos los 
documentos CONFIDENCIALES que genera el ERP. Estos documentos SOLO pueden guardarse 
en el Drive del Service Account (repositorio institucional centralizado).

IMPORTANTE - SEGURIDAD:
- Los documentos son CONFIDENCIALES de la empresa
- NUNCA deben guardarse en Drives personales de los usuarios
- El ERP debe controlar que todos los archivos vayan al repositorio institucional
- Los usuarios pueden NAVEGAR y ELEGIR carpetas, PERO solo dentro del Drive del SA

COMPORTAMIENTO REQUERIDO:
1. Usuario hace login con su cuenta Google (para tracking/audit)
2. Picker muestra SOLO carpetas del Drive del Service Account (NO del usuario)
3. Usuario navega y elige carpeta destino DENTRO del Drive del SA
4. Upload usa credenciales del Service Account
5. Documento queda guardado en el repositorio institucional centralizado

SOLUCIÓN IMPLEMENTADA (PARCIAL):
✅ Upload usa Service Account (implementado en commit d28f509)
❌ Picker aún muestra Drive del usuario (PENDIENTE CORREGIR)

SOLUCIÓN CORRECTA PENDIENTE:
- El Picker debe generar access_token del Service Account
- Pasar ese token al Picker en lugar del token del usuario
- Resultado: Picker mostrará solo carpetas del Drive del SA
- Usuario navega dentro del ecosistema del SA únicamente

RAZÓN DE LA SOLUCIÓN ANTERIOR (INCORRECTA):
Ayer estuvimos intentando hacer esto pero la solucion que logramos fue que la cuenta del 
repositorio compartiera una carpeta con todos los usuarios y esa carpeta sea accesible a traves
del picker. NO es una solucion muy elegante pues lo que se desea es que los upload
al repositorio sea SOLO DESDE EL ERP, manteniendo control total sobre documentos confidenciales.


PROBLEMA #2: CREDENCIALES EXPUESTAS EN GITHUB (RESUELTO)
=========================================================

Adiconalmente, siempre tenemos el mismo problema que los agentes tratan de subir la carpeta 
C:\Users\rguti\mini_erp_v2_antigravity\secrets oauth a GIT. Esta carpeta debe estar en 
GITIGNORE y los secretos directamente en el setting del web de Streamlit

SOLUCIÓN IMPLEMENTADA:
✅ Credenciales rotadas en Google Cloud Console (key antigua deshabilitada)
✅ Historial de Git limpiado con filter-branch (206 commits procesados)
✅ .gitignore reforzado con 4 patrones de protección para secrets
✅ Nuevas credenciales configuradas en secrets.toml
✅ Commits y push realizados (3 sesiones documentadas)

Ayer llego este correo:

Warning	Policy Violation
Immediate action required: Resources associated with your Google Cloud Platform / API project mini-erp-v2-antigravity are being restricted
Dear Developer,
We detected and will disable a publicly exposed Service Account authentication credential associated with the following Google Cloud Platform account:

inandes-drive-service@mini-erp-v2-antigravity.iam.gserviceaccount.com with key ID cc079f4da448aad66500bd6e6a995b846a830eff

This key was found at the following URL: https://github.com/RichGutz/mini_erp_v2_antigravity/blob/01b18752c7e5abd61d985c5146901f27d5097e33/secrets%20oauth/mini-erp-v2-antigravity-cc079f4da448.json

ESTADO: ✅ RESUELTO COMPLETAMENTE
- Key antigua (cc079f4da448...) deshabilitada
- Key nueva (de511e50b7c9...) rotada y segura
- Historial de Git limpio (verificado)
- GitHub sin credenciales expuestas


RESUMEN DE ESTADO:
==================
✅ Problema #2 (Credenciales): RESUELTO COMPLETAMENTE
⏳ Problema #1 (Picker): PARCIALMENTE RESUELTO
   - Upload con SA: ✅ Implementado
   - Picker con SA: ❌ Pendiente (muestra Drive del usuario, debe mostrar Drive del SA)


